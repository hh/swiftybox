# Swifty位Box Container - Local Build Version
# Uses pre-built binary from local .build directory

FROM ubuntu:24.04

# Install minimal runtime dependencies
RUN apt-get update && apt-get install -y \
    ca-certificates \
    && rm -rf /var/lib/apt/lists/*

# Copy the pre-built binary
COPY .build/release/swiftybox /bin/swiftybox

# Install symlinks
RUN cd /bin && /bin/swiftybox --install && \
    ls -la /bin/echo /bin/pwd /bin/true /bin/false

# Verify commands work
RUN /bin/echo "Swifty位Box container build successful\!" && \
    /bin/pwd && \
    /bin/true && echo "true works" && \
    /bin/false || echo "false works (exit 1 expected)"

# Set as default command
CMD ["/bin/swiftybox"]

# Metadata
LABEL description="Swifty位Box - Commands as 位 (lambdas), not processes"
LABEL version="0.2.0"
